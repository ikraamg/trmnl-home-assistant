#!/command/with-contenv bash
# shellcheck shell=bash
# Nginx reverse proxy for HA ingress support

set -e

NGINX_CONF="/etc/terminus/nginx.conf"

echo "[nginx] Starting nginx reverse proxy..."

# Test config before starting
nginx -t -c "$NGINX_CONF" 2>&1 || {
    echo "[nginx] Configuration error, check $NGINX_CONF"
    exit 1
}

# Run nginx in foreground
exec nginx -g "daemon off;" -c "$NGINX_CONF"
